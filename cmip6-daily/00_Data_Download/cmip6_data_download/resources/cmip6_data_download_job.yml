# The main job for cmip6_data_download.
resources:
  jobs:
    cmip6_data_download_job:
      name: cmip6_data_download_job


      tasks:
        - task_key: unit_tests_task
          job_cluster_key: cmip6_dev  # job cluster key
          notebook_task:
            notebook_path: ../tests/download-cmip6-data-run-unit-test.py

        - task_key: run_on_sample_task
          depends_on:
            - task_key: unit_tests_task
          job_cluster_key: cmip6_dev  # job cluster key
          notebook_task:
            notebook_path: ../src/00_Download_cmip6_data.py


      job_clusters:
        - job_cluster_key: cmip6_dev
          new_cluster:
            spark_version: 14.3.x-scala2.12   # Updated Spark version
            node_type_id: m5d.4xlarge  # Updated node type
            runtime_engine: "PHOTON"  # Enabling Photon acceleration
            autoscale:
              min_workers: 2
              max_workers: 8
            data_security_mode: "SINGLE_USER"  # Enforcing Single user access mode
            single_user_name: "smajumder1@ua.edu"  # Username
            custom_tags:
              usage: dev-cmip6-download  # Setting the custom tag
