# The main job for staging_to_bronze.
resources:
  jobs:
    dev_staging_to_bronze_job:
      name: dev_staging_to_bronze_job

      tasks:
        - task_key: unit_tests_task
          job_cluster_key: era5_dev_staging_to_bronze  # Updated job cluster key
          notebook_task:
            notebook_path: ../tests/staging-to-bronze-run-unit-test.py

        - task_key: run_on_sample_task
          depends_on:
            - task_key: unit_tests_task
          job_cluster_key: era5_dev_staging_to_bronze  # Updated job cluster key
          notebook_task:
            notebook_path: ../src/01_Staging_to_Bronze.py

        - task_key: data_value_check_task
          depends_on:
            - task_key: run_on_sample_task  # Depends on the previous notebook
          job_cluster_key: era5_dev_staging_to_bronze  # Updated job cluster key
          notebook_task:
            notebook_path: ../src/01_SM_Data_Value_Check.py  # Path to the new notebook

        - task_key: date_range_check_task
          depends_on:
            - task_key: data_value_check_task  # Depends on the data value check notebook
          job_cluster_key: era5_dev_staging_to_bronze  # Updated job cluster key
          notebook_task:
            notebook_path: ../src/01_SM_Date_Range_Check.py  # Path to the new notebook

      job_clusters:
        - job_cluster_key: era5_dev_staging_to_bronze  # Updated job cluster key
          new_cluster:
            spark_version: 14.3.x-scala2.12  # Updated Spark version
            node_type_id: r5d.xlarge  # Updated node type
            autoscale:
              min_workers: 2  # Updated minimum workers
              max_workers: 8  # Updated maximum workers
            data_security_mode: "SINGLE_USER"  # Enforcing Single user access mode
            single_user_name: "smajumder1@ua.edu"  # Username



